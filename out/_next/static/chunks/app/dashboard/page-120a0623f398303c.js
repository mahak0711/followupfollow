(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{10258:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var l=a(95155),s=a(12115),d=a(8731),r=a(44373),n=a(35317);let i=async function(e,t,a){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{await (0,n.gS)((0,n.rJ)(r.db,"leads",e,"items",t,"activity"),{type:a,timestamp:(0,n.O5)(),metadata:l})}catch(e){console.error("Error logging activity: ",e)}},o=(e,t,a)=>{let l=(0,n.rJ)(r.db,"leads",e,"items",t,"activity"),s=(0,n.P)(l,(0,n.My)("timestamp","desc"),(0,n.AB)(5));return(0,n.aQ)(s,e=>{a(e.docs.map(e=>e.data()))})},c=(e,t)=>{let a=(0,n.rJ)(r.db,"leads",t,"items"),l=(0,n.P)(a);return(0,n.aQ)(l,t=>{let a={New:[],Contacted:[],"Demo Scheduled":[],Closed:[]};t.forEach(e=>{var t;let l=e.data();null==(t=a[l.status])||t.push({id:e.id,...l})}),e(a)})},u=async(e,t,a)=>{try{let l=(0,n.H9)(r.db,"leads",e,"items",t);await (0,n.mZ)(l,{status:a}),await i(e,t,"status_updated",{newStatus:a})}catch(e){console.error("Error updating lead status: ",e)}};var m=a(25472);let x=e=>{let{status:t,leads:a,onCardClick:s}=e,{setNodeRef:d}=(0,m.zM)({id:t});return(0,l.jsxs)("div",{className:"kanban-column bg-white p-6 border rounded-lg w-80 shadow-lg",ref:d,children:[(0,l.jsx)("h3",{className:"font-bold text-xl text-center text-gray-800 mb-4",children:t}),a.map(e=>(0,l.jsx)(h,{lead:e,onClick:()=>s(e)},e.id))]})},h=e=>{let{lead:t,onClick:a}=e,{attributes:s,listeners:d,setNodeRef:r}=(0,m.PM)({id:t.id});return(0,l.jsxs)("div",{className:"kanban-card p-4 mb-4 bg-white border rounded-lg shadow-md hover:shadow-xl transition-all duration-300 cursor-pointer",ref:r,onClick:a,...d,...s,children:[(0,l.jsx)("p",{className:"font-semibold text-black text-lg",children:t.name}),(0,l.jsx)("p",{className:"text-sm text-black",children:t.email}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:t.company})]})},g=e=>{let{onLeadClick:t}=e,[a]=(0,d.hD)(r.j),[n,i]=(0,s.useState)({New:[],Contacted:[],"Demo Scheduled":[],Closed:[]});(0,s.useEffect)(()=>{if(a){let e=c(i,a.uid);return()=>e()}},[a]);let o=(e,t)=>{if(a)try{u(a.uid,e,t)}catch(e){console.error("Error moving lead: ",e)}};return(0,l.jsx)("div",{className:"container mx-auto p-6",children:(0,l.jsx)(m.Mp,{onDragEnd:e=>{let{active:t,over:a}=e;a&&o(t.id,a.id)},children:(0,l.jsx)("div",{className:"kanban-board flex space-x-6",children:["New","Contacted","Demo Scheduled","Closed"].map(e=>(0,l.jsx)(x,{status:e,leads:n[e],onCardClick:t},e))})})})};function b(e){let{lead:t,onClose:a}=e,[n]=(0,d.hD)(r.j),[i,c]=(0,s.useState)([]),[u,m]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{if(!n||!(null==t?void 0:t.id))return;let e=o(n.uid,t.id,e=>{c(e),m(!1)});return()=>e()},[n,null==t?void 0:t.id]),(0,l.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-lg relative",children:[(0,l.jsx)("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",onClick:a,children:"âœ•"}),(0,l.jsxs)("h2",{className:"text-xl font-semibold text-stone-800 mb-4",children:["Lead Details - ",t.name]}),(0,l.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:t.email}),(0,l.jsx)("h3",{className:"font-medium  text-gray-500  text-lg mb-2",children:"Recent Activity"}),u?(0,l.jsx)("p",{children:"Loading..."}):0===i.length?(0,l.jsx)("p",{className:"text-gray-500",children:"No recent activity"}):(0,l.jsx)("ul",{className:"space-y-2",children:i.map(e=>{var t,a,s;return(0,l.jsxs)("li",{className:"text-sm text-gray-700 border-b py-2",children:[(0,l.jsx)("strong",{children:e.type.replace(/_/g," ")})," -"," ",(null==(t=e.metadata)?void 0:t.note)||(null==(a=e.metadata)?void 0:a.newStatus)||"Details not available",(0,l.jsx)("div",{className:"text-xs text-gray-400",children:null==(s=e.timestamp)?void 0:s.toDate().toLocaleString()})]},e.id)})})]})})}var p=a(83540),f=a(23218),y=a(8784),j=a(36079),v=a(93504),w=a(94754),N=a(96025),C=a(16238),S=a(94517),D=a(24026),k=a(21374);let E=["New","Contacted","Demo Scheduled","Closed"],A=()=>{let[e]=(0,d.hD)(r.j),[t,a]=(0,s.useState)([]),[i,o]=(0,s.useState)([]),[c,u]=(0,s.useState)(0),[m,x]=(0,s.useState)(0);return(0,s.useEffect)(()=>{if(!e)return;let t=(0,n.rJ)(r.db,"leads",e.uid,"items"),l=(0,n.aQ)(t,e=>{let t={New:0,Contacted:0,"Demo Scheduled":0,Closed:0};e.forEach(e=>{let a=e.data();E.includes(a.status)&&t[a.status]++}),a([{name:"New",value:t.New,fill:"#60a5fa"},{name:"Contacted",value:t.Contacted,fill:"#34d399"},{name:"Demo Scheduled",value:t["Demo Scheduled"],fill:"#fbbf24"},{name:"Closed",value:t.Closed,fill:"#f87171"}])}),s=(0,n.aQ)(t,e=>{let t={};e.forEach(e=>{var a;let l=e.data();if(null==(a=l.createdAt)?void 0:a.toDate){let e=l.createdAt.toDate().toISOString().split("T")[0];t[e]=(t[e]||0)+1}}),o(Object.keys(t).map(e=>({date:e,count:t[e]})).sort((e,t)=>new Date(e.date)-new Date(t.date)))}),d=(0,n.aQ)((0,n.rJ)(r.db,"activities",e.uid,"logs"),e=>{let t=0,a=0,l=0,s=0;e.forEach(e=>{let d=e.data();"lead_created"===d.type?t++:"lead_closed"===d.type&&(a++,d.timeInStage&&(l+=d.timeInStage,s++))}),u(t>0?(a/t*100).toFixed(2):0),x(s>0?(l/s).toFixed(2):0)});return()=>{l(),s(),d()}},[e]),(0,l.jsxs)("div",{className:"p-6 min-h-screen",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-center text-blue-700 mb-8",children:"Analytics Dashboard"}),(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-sm mb-6",children:[(0,l.jsx)("h2",{className:"text-xl font-medium text-gray-600 mb-4",children:"Lead Funnel"}),(0,l.jsx)("div",{style:{width:"100%",height:300},children:(0,l.jsx)(p.u,{width:"100%",height:"100%",children:(0,l.jsx)(f.v,{children:(0,l.jsx)(y.r,{data:t,dataKey:"value",isAnimationActive:!0,shape:"rectangular",children:(0,l.jsx)(j.Z,{position:"center",dataKey:"name",fill:"#000",fontSize:16})})})})})]}),(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg mb-8",children:[(0,l.jsx)("h2",{className:"text-2xl font-semibold text-gray-700 mb-4",children:"Leads Created per Day"}),(0,l.jsx)(p.u,{width:"100%",height:300,children:(0,l.jsxs)(v.b,{data:i,children:[(0,l.jsx)(w.d,{strokeDasharray:"3 3"}),(0,l.jsx)(N.W,{dataKey:"date"}),(0,l.jsx)(C.h,{}),(0,l.jsx)(S.m,{}),(0,l.jsx)(D.s,{}),(0,l.jsx)(k.N,{type:"monotone",dataKey:"count",stroke:"#8884d8"})]})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Conversion Rate"}),(0,l.jsxs)("p",{className:"text-3xl font-semibold text-blue-600",children:[c,"%"]})]}),(0,l.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Average Time in Stage (days)"}),(0,l.jsxs)("p",{className:"text-3xl font-semibold text-blue-600",children:[m," days"]})]})]})]})},L=["New","Contacted","Demo Scheduled","Closed"],_=async(e,t)=>{let a=(0,n.rJ)(r.db,"leads",e,"items");await (0,n.gS)(a,{...t,status:"New",createdAt:n.Dc.now()})},I=()=>{let[e]=(0,d.hD)(r.j),[t,a]=(0,s.useState)([]),[i,o]=(0,s.useState)(null),[c,u]=(0,s.useState)(!1),[m,x]=(0,s.useState)(!1),[h,p]=(0,s.useState)({name:"",email:"",company:"",note:"",followUpDate:""});return(0,s.useEffect)(()=>{if(!e)return;let t=(0,n.rJ)(r.db,"leads",e.uid,"items"),l=(0,n.aQ)(t,e=>{let t=L.map(e=>({id:e,title:e,leads:[]}));e.forEach(e=>{let a={id:e.id,...e.data()},l=L.findIndex(e=>e===a.status);-1!==l&&t[l].leads.push(a)}),console.log("Fetched Leads by Stage:",t),a(t)});return()=>l()},[e]),(0,l.jsxs)("div",{className:"bg-gray-50  p-6",children:[(0,l.jsxs)("div",{className:"max-w-7xl mx-auto flex justify-between items-center mb-6",children:[(0,l.jsx)("h1",{className:"text-3xl font-semibold text-gray-800",children:"Kanban Dashboard"}),(0,l.jsx)("button",{onClick:()=>x(!0),className:"bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none transition duration-200",children:"Add Lead"})]}),m&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-sm p-6 shadow-xl transition-all transform",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Add New Lead"}),(0,l.jsx)("input",{type:"text",placeholder:"Name",value:h.name,onChange:e=>p({...h,name:e.target.value}),className:"w-full p-3 mb-4 border border-gray-300 text-gray-400 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,l.jsx)("input",{type:"email",placeholder:"Email",value:h.email,onChange:e=>p({...h,email:e.target.value}),className:"w-full p-3 mb-4 border border-gray-300 rounded-md text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,l.jsx)("input",{type:"text",placeholder:"Company",value:h.company,onChange:e=>p({...h,company:e.target.value}),className:"w-full p-3 mb-6 border border-gray-300 text-gray-400 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,l.jsx)("textarea",{placeholder:"Note",value:h.note,onChange:e=>p({...h,note:e.target.value}),className:"w-full p-3 mb-4 border border-gray-300 text-gray-400 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,l.jsx)("input",{type:"date",value:h.followUpDate,onChange:e=>p({...h,followUpDate:e.target.value}),className:"w-full p-3 mb-6 border border-gray-300 text-gray-400 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-600"}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("button",{onClick:()=>x(!1),className:"text-gray-600 py-2 px-4 rounded-md hover:bg-gray-100 transition-all",children:"Cancel"}),(0,l.jsx)("button",{onClick:()=>{if(e)try{_(e.uid,h),p({name:"",email:"",company:""}),x(!1)}catch(e){console.error("Error adding lead: ",e)}},className:"bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none transition-all",children:"Add Lead"})]})]})}),(0,l.jsx)(g,{initialColumns:t,onLeadClick:e=>{console.log("Lead clicked:",e),o(e),u(!0)}}),c&&(0,l.jsx)(b,{lead:i,onClose:()=>u(!1)}),(0,l.jsx)(A,{})]})}},44373:(e,t,a)=>{"use strict";a.d(t,{db:()=>i,j:()=>n});var l=a(23915),s=a(35317),d=a(93004);let r=(0,l.Wp)({apiKey:"AIzaSyDeQvovey0J_Rz4szXmm8e1Zp3KL_-kMjI",authDomain:"followupfollow-6c896.firebaseapp.com",projectId:"followupfollow-6c896",storageBucket:"followupfollow-6c896.firebasestorage.app",messagingSenderId:"1:666938776431:web:46f60e52f5ba064b71a69a",appId:"G-MJDKP4LGB0"}),n=(0,d.xI)(r),i=(0,s.aU)(r)},83458:(e,t,a)=>{Promise.resolve().then(a.bind(a,10258))}},e=>{var t=t=>e(e.s=t);e.O(0,[992,156,873,646,441,684,358],()=>t(83458)),_N_E=e.O()}]);